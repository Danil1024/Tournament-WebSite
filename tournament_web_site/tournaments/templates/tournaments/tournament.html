{% extends 'base.html' %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/tournament.css' %}" />
{% endblock %}

{% block title %}
Champion's Realm
{% endblock %}

{% block content %}
<div class="tournament-content">
    <div class="tournament-header">
        <h2 class="tournament-name">{{tournament|upper}}</h2>
    </div>
    {% if my_teams %}
    <div class="registration-form" data-register-url="{% url 'register-for-tournament' tournament.pk %}">
        <div class="form-group">
            <label for="team-select" class="form-label">Выберите команду</label>
            <select id="team-select" class="form-select">
                <option value="">— Выберите команду —</option>
                {% for team in my_teams %}
                <option value="{{ team.id }}">{{ team.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group roster-section" id="roster-section" hidden>
            <label class="form-label">
                Выберите состав (<span id="roster-count">0</span>/<span id="roster-max">{{ tournament.team_size }}</span>)
            </label>
            <p class="roster-hint">Кликните по участникам, чтобы добавить их в состав</p>
            <div class="roster-players-list" id="roster-players-list"></div>
        </div>
        <div class="registration-form-actions">
            <button class="green-button">ЗАРЕГИСТРИРОВАТЬСЯ</button>
        </div>
    </div>
    {{ teams_config|json_script:"teams-data" }}
    {% else %}
    <p class="registration-empty-message">Для участия вам нужно создать команду или вступить в нее</p>
    {% endif %}

    <div class="tournament-params">
        <div class="tournament-param">
            <p class="tournament-param-name">Дата регистрации</p>
            <p class="tournament-param-value">{{tournament.registration_start_date|date:"d.m.Y"}}</p>
        </div>
        <div class="tournament-param">
            <p class="tournament-param-name">Дата начала</p>
            <p class="tournament-param-value">{{tournament.start_date|date:"d.m.Y"}}</p>
        </div>
        <div class="tournament-param">
            <p class="tournament-param-name">Тип команды</p>
            <p class="tournament-param-value">{{tournament.get_team_size_display }}</p>
        </div>
        <div class="tournament-param">
            <p class="tournament-param-name">Призовой фонд</p>
            <p class="tournament-param-value">{{prize_fund}}</p>
        </div>
        <div class="tournament-param">
            <p class="tournament-param-name">Взнос</p>
            <p class="tournament-param-value">{{tournament.price}}</p>
        </div>
        <div class="tournament-param">
            <p class="tournament-param-name">Оставшиеся места</p>
            <p class="tournament-param-value">{{remaining_places}}</p>
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
{% if my_teams %}
<script src="{% static 'js/tournament_registration.js' %}"></script>
{% endif %}
{% endblock %}